<!doctype html>
<html lang="vi" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ƒêƒÉng nh·∫≠p - English Blossom</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(-30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    @keyframes float {
      0%, 100% {
        transform: translateY(0px) rotate(0deg);
      }
      50% {
        transform: translateY(-15px) rotate(5deg);
      }
    }
    
    .fade-in {
      animation: fadeIn 0.6s ease-out forwards;
    }
    
    .slide-in {
      animation: slideIn 0.5s ease-out forwards;
    }
    
    .float-animation {
      animation: float 4s ease-in-out infinite;
    }
    
    .form-container {
      backdrop-filter: blur(10px);
      background: rgba(255, 255, 255, 0.95);
    }
    
    .input-field {
      transition: all 0.3s ease;
    }
    
    .input-field:focus {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(236, 72, 153, 0.15);
    }
    
    .btn-primary {
      transition: all 0.3s ease;
      background: linear-gradient(135deg, #ec4899 0%, #f472b6 100%);
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(236, 72, 153, 0.4);
    }
    
    .tab-button {
      transition: all 0.3s ease;
      position: relative;
    }
    
    .tab-button.active::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(135deg, #ec4899 0%, #f472b6 100%);
      border-radius: 3px 3px 0 0;
    }
    
    .social-btn {
      transition: all 0.3s ease;
    }
    
    .social-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, #fce7f3 0%, #ffffff 50%, #fff1f2 100%);
    }
    
    .circle-decoration {
      position: absolute;
      border-radius: 50%;
      opacity: 0.1;
    }
    
    .error-message {
      color: #ef4444;
      font-size: 0.875rem;
      margin-top: 0.25rem;
      display: none;
    }
    
    .error-message.show {
      display: block;
      animation: fadeIn 0.3s ease-out;
    }
    
    .success-message {
      background: #dcfce7;
      color: #166534;
      padding: 1rem;
      border-radius: 0.75rem;
      margin-bottom: 1rem;
      display: none;
      border: 2px solid #86efac;
    }
    
    .success-message.show {
      display: block;
      animation: fadeIn 0.3s ease-out;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="h-full w-full">
  <div id="app" class="w-full h-full overflow-auto gradient-bg"><!-- Decorative elements -->
   <div class="circle-decoration float-animation" style="width: 250px; height: 250px; background: #ec4899; top: -80px; right: -80px;"></div>
   <div class="circle-decoration float-animation" style="width: 180px; height: 180px; background: #f472b6; bottom: 50px; left: -60px; animation-delay: 1s;"></div>
   <div class="circle-decoration float-animation" style="width: 120px; height: 120px; background: #fda4af; top: 40%; right: 10%; animation-delay: 2s;"></div>
   <div class="flex items-center justify-center min-h-full py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-md w-full"><!-- Logo and Title -->
     <div class="text-center mb-8 fade-in">
      <div class="text-6xl mb-4 float-animation">
       üå∏
      </div>
      <h1 id="pageTitle" class="text-4xl font-bold mb-2" style="background: linear-gradient(135deg, #ec4899 0%, #f43f5e 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">English Blossom</h1>
      <p id="welcomeText" class="text-gray-600 text-lg">Ch√†o m·ª´ng b·∫°n tr·ªü l·∫°i! üíñ</p>
     </div><!-- Form Container -->
     <div class="form-container rounded-3xl shadow-2xl p-8 border-4 border-pink-100"><!-- Tabs -->
      <div class="flex mb-8 bg-pink-50 rounded-2xl p-2"><button id="loginTab" class="tab-button active flex-1 py-3 rounded-xl font-semibold text-pink-600 bg-white"> ƒêƒÉng nh·∫≠p </button> <button id="signupTab" class="tab-button flex-1 py-3 rounded-xl font-semibold text-gray-600"> ƒêƒÉng k√Ω </button>
      </div><!-- Success Message -->
      <div id="successMessage" class="success-message">
       <div class="flex items-center"><span class="text-2xl mr-2">‚úì</span> <span id="successText"></span>
       </div>
      </div><!-- Login Form -->
      <form id="loginForm" class="slide-in">
       <div class="space-y-5">
        <div><label for="loginEmail" class="block text-sm font-semibold text-gray-700 mb-2">Email</label> <input type="email" id="loginEmail" class="input-field w-full px-4 py-3 border-2 border-pink-200 rounded-xl focus:outline-none focus:border-pink-400" placeholder="your@email.com" required>
         <div class="error-message" id="loginEmailError">
          Vui l√≤ng nh·∫≠p email h·ª£p l·ªá
         </div>
        </div>
        <div><label for="loginPassword" class="block text-sm font-semibold text-gray-700 mb-2">M·∫≠t kh·∫©u</label>
         <div class="relative"><input type="password" id="loginPassword" class="input-field w-full px-4 py-3 border-2 border-pink-200 rounded-xl focus:outline-none focus:border-pink-400" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required> <button type="button" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-pink-500" onclick="togglePassword('loginPassword')"> üëÅÔ∏è </button>
         </div>
         <div class="error-message" id="loginPasswordError">
          M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±
         </div>
        </div>
        <div class="flex items-center justify-between"><label class="flex items-center"> <input type="checkbox" class="w-4 h-4 text-pink-500 border-pink-300 rounded focus:ring-pink-400"> <span class="ml-2 text-sm text-gray-600">Ghi nh·ªõ ƒëƒÉng nh·∫≠p</span> </label> <a href="#" class="text-sm font-semibold text-pink-600 hover:text-pink-700">Qu√™n m·∫≠t kh·∫©u?</a>
        </div><button type="submit" class="btn-primary w-full text-white font-bold py-4 rounded-xl text-lg"> ƒêƒÉng nh·∫≠p üå∏ </button>
       </div>
      </form><!-- Signup Form -->
      <form id="signupForm" class="hidden">
       <div class="space-y-5">
        <div><label for="signupName" class="block text-sm font-semibold text-gray-700 mb-2">H·ªç v√† t√™n</label> <input type="text" id="signupName" class="input-field w-full px-4 py-3 border-2 border-pink-200 rounded-xl focus:outline-none focus:border-pink-400" placeholder="Nguy·ªÖn VƒÉn A" required>
         <div class="error-message" id="signupNameError">
          Vui l√≤ng nh·∫≠p h·ªç t√™n
         </div>
        </div>
        <div><label for="signupEmail" class="block text-sm font-semibold text-gray-700 mb-2">Email</label> <input type="email" id="signupEmail" class="input-field w-full px-4 py-3 border-2 border-pink-200 rounded-xl focus:outline-none focus:border-pink-400" placeholder="your@email.com" required>
         <div class="error-message" id="signupEmailError">
          Vui l√≤ng nh·∫≠p email h·ª£p l·ªá
         </div>
        </div>
        <div><label for="signupPassword" class="block text-sm font-semibold text-gray-700 mb-2">M·∫≠t kh·∫©u</label>
         <div class="relative"><input type="password" id="signupPassword" class="input-field w-full px-4 py-3 border-2 border-pink-200 rounded-xl focus:outline-none focus:border-pink-400" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required> <button type="button" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-pink-500" onclick="togglePassword('signupPassword')"> üëÅÔ∏è </button>
         </div>
         <div class="error-message" id="signupPasswordError">
          M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±
         </div>
        </div>
        <div><label for="signupConfirmPassword" class="block text-sm font-semibold text-gray-700 mb-2">X√°c nh·∫≠n m·∫≠t kh·∫©u</label>
         <div class="relative"><input type="password" id="signupConfirmPassword" class="input-field w-full px-4 py-3 border-2 border-pink-200 rounded-xl focus:outline-none focus:border-pink-400" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required> <button type="button" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-pink-500" onclick="togglePassword('signupConfirmPassword')"> üëÅÔ∏è </button>
         </div>
         <div class="error-message" id="signupConfirmPasswordError">
          M·∫≠t kh·∫©u x√°c nh·∫≠n kh√¥ng kh·ªõp
         </div>
        </div><label class="flex items-start"> <input type="checkbox" class="w-4 h-4 mt-1 text-pink-500 border-pink-300 rounded focus:ring-pink-400" required> <span class="ml-2 text-sm text-gray-600">T√¥i ƒë·ªìng √Ω v·ªõi <a href="#" class="text-pink-600 font-semibold">ƒêi·ªÅu kho·∫£n d·ªãch v·ª•</a> v√† <a href="#" class="text-pink-600 font-semibold">Ch√≠nh s√°ch b·∫£o m·∫≠t</a></span> </label> <button type="submit" class="btn-primary w-full text-white font-bold py-4 rounded-xl text-lg"> ƒêƒÉng k√Ω ngay üå∫ </button>
       </div>
      </form><!-- Divider -->
      <div class="relative my-8">
       <div class="absolute inset-0 flex items-center">
        <div class="w-full border-t-2 border-pink-100"></div>
       </div>
       <div class="relative flex justify-center text-sm"><span class="px-4 bg-white text-gray-500 font-semibold">Ho·∫∑c ti·∫øp t·ª•c v·ªõi</span>
       </div>
      </div><!-- Social Login -->
      <div class="grid grid-cols-2 gap-4"><button class="social-btn flex items-center justify-center px-4 py-3 border-2 border-gray-200 rounded-xl hover:bg-gray-50">
        <svg class="w-5 h-5 mr-2" viewbox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" /> <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" /> <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" /> <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
        </svg><span class="text-sm font-semibold text-gray-700">Google</span> </button> <button class="social-btn flex items-center justify-center px-4 py-3 border-2 border-gray-200 rounded-xl hover:bg-gray-50">
        <svg class="w-5 h-5 mr-2" fill="#1877F2" viewbox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
        </svg><span class="text-sm font-semibold text-gray-700">Facebook</span> </button>
      </div>
     </div><!-- Footer Text -->
     <p class="text-center mt-6 text-sm text-gray-600">H·ªçc ti·∫øng Anh m·ªói ng√†y c√πng English Blossom üå∏</p>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      page_title: "English Blossom",
      welcome_text: "Ch√†o m·ª´ng b·∫°n tr·ªü l·∫°i! üíñ",
      login_tab: "ƒêƒÉng nh·∫≠p",
      signup_tab: "ƒêƒÉng k√Ω",
      login_button: "ƒêƒÉng nh·∫≠p üå∏",
      signup_button: "ƒêƒÉng k√Ω ngay üå∫",
      primary_color: "#ec4899",
      secondary_color: "#f472b6",
      accent_color: "#f43f5e",
      text_color: "#1f2937",
      background_color: "#fce7f3"
    };

    // Tab switching
    const loginTab = document.getElementById('loginTab');
    const signupTab = document.getElementById('signupTab');
    const loginForm = document.getElementById('loginForm');
    const signupForm = document.getElementById('signupForm');
    const successMessage = document.getElementById('successMessage');

    loginTab.addEventListener('click', () => {
      loginTab.classList.add('active', 'bg-white', 'text-pink-600');
      loginTab.classList.remove('text-gray-600');
      signupTab.classList.remove('active', 'bg-white', 'text-pink-600');
      signupTab.classList.add('text-gray-600');
      
      loginForm.classList.remove('hidden');
      loginForm.classList.add('slide-in');
      signupForm.classList.add('hidden');
      successMessage.classList.remove('show');
    });

    signupTab.addEventListener('click', () => {
      signupTab.classList.add('active', 'bg-white', 'text-pink-600');
      signupTab.classList.remove('text-gray-600');
      loginTab.classList.remove('active', 'bg-white', 'text-pink-600');
      loginTab.classList.add('text-gray-600');
      
      signupForm.classList.remove('hidden');
      signupForm.classList.add('slide-in');
      loginForm.classList.add('hidden');
      successMessage.classList.remove('show');
    });

    // Password toggle
    function togglePassword(fieldId) {
      const field = document.getElementById(fieldId);
      field.type = field.type === 'password' ? 'text' : 'password';
    }

    // Validation functions
    function validateEmail(email) {
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return re.test(email);
    }

    function showError(errorId) {
      document.getElementById(errorId).classList.add('show');
    }

    function hideError(errorId) {
      document.getElementById(errorId).classList.remove('show');
    }

    function showSuccess(message) {
      document.getElementById('successText').textContent = message;
      successMessage.classList.add('show');
      setTimeout(() => {
        successMessage.classList.remove('show');
      }, 5000);
    }

    // Login form validation
loginForm.addEventListener('submit', async (e) => {
  e.preventDefault();
  let isValid = true;

  const email = document.getElementById('loginEmail').value;
  const password = document.getElementById('loginPassword').value;

  hideError('loginEmailError');
  hideError('loginPasswordError');

  if (!validateEmail(email)) {
    showError('loginEmailError');
    isValid = false;
  }

  if (password.length < 6) {
    showError('loginPasswordError');
    isValid = false;
  }

  if (!isValid) return;

  const res = await fetch("/api/auth/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ email, password }),
  });

  const data = await res.json();

  if (!res.ok) {
    alert(data.message || "Login failed");
    return;
  }

  localStorage.setItem("token", data.token);

  window.location.href = "index.html";
});


    // Signup form validation
    signupForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      let isValid = true;

      const name = document.getElementById('signupName').value;
      const email = document.getElementById('signupEmail').value;
      const password = document.getElementById('signupPassword').value;
      const confirmPassword = document.getElementById('signupConfirmPassword').value;

      hideError('signupNameError');
      hideError('signupEmailError');
      hideError('signupPasswordError');
      hideError('signupConfirmPasswordError');

      if (name.trim() === '') {
        showError('signupNameError');
        isValid = false;
      }

      if (!validateEmail(email)) {
        showError('signupEmailError');
        isValid = false;
      }

      if (password.length < 6) {
        showError('signupPasswordError');
        isValid = false;
      }

      if (password !== confirmPassword) {
        showError('signupConfirmPasswordError');
        isValid = false;
      }

     if (!isValid) return;

const res = await fetch("/api/auth/register", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    email,
    password,
  }),
});

const data = await res.json();

if (!res.ok) {
  alert(data.message || "ƒêƒÉng k√Ω th·∫•t b·∫°i");
  return;
}

showSuccess("ƒêƒÉng k√Ω th√†nh c√¥ng! H√£y ƒëƒÉng nh·∫≠p ƒë·ªÉ ti·∫øp t·ª•c üå∏");
signupForm.reset();

    });

    // Element SDK integration
    async function onConfigChange(config) {
      document.getElementById('pageTitle').textContent = config.page_title || defaultConfig.page_title;
      document.getElementById('welcomeText').textContent = config.welcome_text || defaultConfig.welcome_text;
      document.getElementById('loginTab').textContent = config.login_tab || defaultConfig.login_tab;
      document.getElementById('signupTab').textContent = config.signup_tab || defaultConfig.signup_tab;
      
      const primaryColor = config.primary_color || defaultConfig.primary_color;
      const secondaryColor = config.secondary_color || defaultConfig.secondary_color;
      
      document.getElementById('pageTitle').style.background = `linear-gradient(135deg, ${primaryColor} 0%, ${config.accent_color || defaultConfig.accent_color} 100%)`;
      document.getElementById('pageTitle').style.webkitBackgroundClip = 'text';
      document.getElementById('pageTitle').style.webkitTextFillColor = 'transparent';
      document.getElementById('pageTitle').style.backgroundClip = 'text';
      
      document.querySelectorAll('.btn-primary').forEach(el => {
        el.style.background = `linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%)`;
      });
    }

    function mapToCapabilities(config) {
      return {
        recolorables: [
          {
            get: () => config.primary_color || defaultConfig.primary_color,
            set: (value) => {
              config.primary_color = value;
              window.elementSdk.setConfig({ primary_color: value });
            }
          },
          {
            get: () => config.secondary_color || defaultConfig.secondary_color,
            set: (value) => {
              config.secondary_color = value;
              window.elementSdk.setConfig({ secondary_color: value });
            }
          },
          {
            get: () => config.accent_color || defaultConfig.accent_color,
            set: (value) => {
              config.accent_color = value;
              window.elementSdk.setConfig({ accent_color: value });
            }
          },
          {
            get: () => config.text_color || defaultConfig.text_color,
            set: (value) => {
              config.text_color = value;
              window.elementSdk.setConfig({ text_color: value });
            }
          },
          {
            get: () => config.background_color || defaultConfig.background_color,
            set: (value) => {
              config.background_color = value;
              window.elementSdk.setConfig({ background_color: value });
            }
          }
        ],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      };
    }

    function mapToEditPanelValues(config) {
      return new Map([
        ["page_title", config.page_title || defaultConfig.page_title],
        ["welcome_text", config.welcome_text || defaultConfig.welcome_text],
        ["login_tab", config.login_tab || defaultConfig.login_tab],
        ["signup_tab", config.signup_tab || defaultConfig.signup_tab],
        ["login_button", config.login_button || defaultConfig.login_button],
        ["signup_button", config.signup_button || defaultConfig.signup_button]
      ]);
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9b203b51c12520e3',t:'MTc2NjQxMjkzMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>

 </body>
</html>